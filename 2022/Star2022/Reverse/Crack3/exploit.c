#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main(){
	int r,r1,r2,tmp,array_value;
	FILE *out = fopen("out","wb");
	FILE *in = fopen("crackme3","rb");
	fseek(in, 12392, SEEK_SET);
	for(int i=0;i<0x30c0e; i++){
		fread(&array_value,1,1,in);
	
		r = rand(); /*pseudo aléatoire non initialisé -> 1*/
		r1 = r & 0xff;
		r2 = (r/0xff) & 0xff;
		tmp = (r1+r2) ^array_value;

		fwrite(&tmp,1,1,out);
	}
}
